/**
 * UTILS.JS - Mathematical Sequences & Music Theory Data
 *
 * This file contains all the raw data that drives the musical experience:
 * - Mathematical sequences (Pi, Phi, Fibonacci)
 * - Musical scales (mapping digits → notes)
 * - MIDI note mappings
 * - Instrument library
 * - Synesthesia color table
 * - Preset configurations
 *
 * DATA SOURCES:
 * - Pi: First 8677+ digits after decimal point
 * - Phi (Golden Ratio): ~1000 digits after decimal point
 * - Fibonacci: Concatenated Fibonacci sequence digits (~1000+ digits)
 */

// ============================================================================
// MATHEMATICAL SEQUENCES
// ============================================================================

/**
 * Test sequence - Simple linear pattern for debugging
 * Repeats "0123456789" to test all digit → note mappings
 */
var test ="01234567890123456789012345678901234567890123456789"

/**
 * Pi (π) - First 8677 digits after the decimal point
 * Value: 3.14159265358979323846...
 *
 * Source: High-precision calculation
 * Usage: Default sequence, provides rich non-repeating pattern
 *
 * Note: Stored as string without decimal point (starts with "3141592...")
 * The leading "3" is preserved for historical/display purposes
 */
var pi =
"31415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632788659361533818279682303019520353018529689957736225994138912497217752834791315155748572424541506959508295331168617278558890750983817546374649393192550604009277016711390098488240128583616035637076601047101819429555961989467678374494482553797747268471040475346462080466842590694912933136770289891521047521620569660240580381501935112533824300355876402474964732639141992726042699227967823547816360093417216412199245863150302861829745557067498385054945885869269956909272107975093029553211653449872027559602364806654991198818347977535663698074265425278625518184175746728909777727938000816470600161452491921732172147723501414419735685481613611573525521334757418494684385233239073941433345477624168625189835694855620992192221842725502542568876717904946016534668049886272327917860857843838279679766814541009538837863609506800642251252051173929848960841284886269456042419652850222106611863067442786220391949450471237137869609563643719172874677646575739624138908658326459958133904780275900994657640789512694683983525957098258226205224894077267194782684826014769909026401363944374553050682034962524517493996514314298091906592509372216964615157098583874105978859597729754989301617539284681382686838689427741559918559252459539594310499725246808459872736446958486538367362226260991246080512438843904512441365497627807977156914359977001296160894416948685558484063534220722258284886481584560285060168427394522674676788952521385225499546667278239864565961163548862305774564980355936345681743241125150760694794510965960940252288797108931456691368672287489405601015033086179286809208747609178249385890097149096759852613655497818931297848216829989487226588048575640142704775551323796414515237462343645428584447952658678210511413547357395231134271661021359695362314429524849371871101457654035902799344037420073105785390621983874478084784896833214457138687519435064302184531910484810053706146806749192781911979399520614196634287544406437451237181921799983910159195618146751426912397489409071864942319615679452080951465502252316038819301420937621378559566389377870830390697920773467221825625996615014215030680384477345492026054146659252014974428507325186660021324340881907104863317346496514539057962685610055081066587969981635747363840525714591028970641401109712062804390397595156771577004203378699360072305587631763594218731251471205329281918261861258673215791984148488291644706095752706957220917567116722910981690915280173506712748583222871835209353965725121083579151369882091444210067510334671103141267111369908658516398315019701651511685171437657618351556508849099898599823873455283316355076479185358932261854896321329330898570642046752590709154814165498594616371802709819943099244889575712828905923233260972997120844335732654893823911932597463667305836041428138830320382490375898524374417029132765618093773444030707469211201913020330380197621101100449293215160842444859637669838952286847831235526582131449576857262433441893039686426243410773226978028073189154411010446823252716201052652272111660396665573092547110557853763466820653109896526918620564769312570586356620185581007293606598764861179104533488503461136576867532494416680396265797877185560845529654126654085306143444318586769751456614068007002378776591344017127494704205622305389945613140711270004078547332699390814546646458807972708266830634328587856983052358089330657574067954571637752542021149557615814002501262285941302164715509792592309907965473761255176567513575178296664547791745011299614890304639947132962107340437518957359614589019389713111790429782856475032031986915140287080859904801094121472213179476477726224142548545403321571853061422881375850430633217518297986622371721591607716692547487389866549494501146540628433663937900397692656721463853067360965712091807638327166416274888800786925602902284721040317211860820419000422966171196377921337575114959501566049631862947265473642523081770367515906735023507283540567040386743513622224771589150495309844489333096340878076932599397805419341447377441842631298608099888687413260472156951623965864573021631598193195167353812974167729478672422924654366800980676928238280689964004824354037014163149658979409243237896907069779422362508221688957383798623001593776471651228935786015881617557829735233446042815126272037343146531977774160319906655418763979293344195215413418994854447345673831624993419131814809277771038638773431772075456545322077709212019051660962804909263601975988281613323166636528619326686336062735676303544776280350450777235547105859548702790814356240145171806246436267945612753181340783303362542327839449753824372058353114771199260638133467768796959703098339130771098704085913374641442822772634659470474587847787201927715280731767907707157213444730605700733492436931138350493163128404251219256517980694113528013147013047816437885185290928545201165839341965621349143415956258658655705526904965209858033850722426482939728584783163057777560688876446248246857926039535277348030480290058760758251047470916439613626760449256274204208320856611906254543372131535958450687724602901618766795240616342522577195429162991930645537799140373404328752628889639958794757291746426357455254079091451357111369410911939325191076020825202618798531887705842972591677813149699009019211697173727847684726860849003377024242916513005005168323364350389517029893922334517220138128069650117844087451960121228599371623130171144484640903890644954440061986907548516026327505298349187407866808818338510228334508504860825039302133219715518430635455007668282949304137765527939751754613953984683393638304746119966538581538420568533862186725233402830871123282789212507712629463229563989898935821167456270102183564622013496715188190973038119800497340723961036854066431939509790190699639552453005450580685501956730229219139339185680344903982059551002263535361920419947455385938102343955449597783779023742161727111723643435439478221818528624085140066604433258885698670543154706965747458550332323342107301545940516553790686627333799585115625784322988273723198987571415957811196358330059408730681216028764962867446047746491599505497374256269010490377819868359381465741268049256487985561453723478673303904688383436346553794986419270563872931748723320837601123029911367938627089438799362016295154133714248928307220126901475466847653576164773794675200490757155527819653621323926406160136358155907422020203187277605277219005561484255518792530343513984425322341576233610642506390497500865627109535919465897514131034822769306247435363256916078154781811528436679570611086153315044521274739245449454236828860613408414863776700961207151249140430272538607648236341433462351897576645216413767969031495019108575984423919862916421939949072362346468441173940326591840443780513338945257423995082965912285085558215725031071257012668302402929525220118726767562204154205161841634847565169998116141010029960783869092916030288400269104140792886215078424516709087000699282120660418371806535567252532567532861291042487761825829765157959847035622262934860034158722980534989650226291748788202734209222245339856264766914905562842503912757710284027998066365825488926488025456610172967026640765590429099456815065265305371829412703369313785178609040708667114965583434347693385781711386455873678123014587687126603489139095620099393610310291616152881384379099042317473363948045759314931405297634757481193567091101377517210080315590248530906692037671922033229094334676851422144773793937517034436619910403375111735471918550464490263655128162288244625759163330391072253837421821408835086573917715096828874782656995995744906617583441375223970968340800535598491754173818839994469748676265516582765848358845314277568790029095170283529716344562129640435231176006651012412006597558512761785838292041974844236080071930457618";
/**
 * Phi (φ) - Golden Ratio: ~1000 digits after decimal point
 * Value: 1.61803398874989484820...
 *
 * Mathematical constant: (1 + √5) / 2
 * Properties:
 * - Appears in nature (spiral shells, flowers, tree branching)
 * - Used in art/architecture (Parthenon, Mona Lisa)
 * - Relationship: φ² = φ + 1
 *
 * Musical potential: Less variation than Pi, may create more repetitive patterns
 */
var phi =
"161803398874989484820458683436563811772030917980576286213544862270526046281890244970720720418939113748475408807538689175212663386222353693179318006076672635443338908659593958290563832266131992829026788067520876689250171169620703222104321626954862629631361443814975870122034080588795445474924618569536486444924104432077134494704956584678850987433944221254487706647809158846074998871240076521705751797883416625624940758906970400028121042762177111777805315317141011704666599146697987317613560067087480710131795236894275219484353056783002287856997829778347845878228911097625003026961561700250464338243776486102838312683303724292675263116533924731671112115881863851331620384005222165791286675294654906811317159934323597349498509040947621322298101726107059611645629909816290555208524790352406020172799747175342777592778625619432082750513121815628551222480939471234145170223735805772786160086883829523045926478780178899219902707769038953219681986151437803149974110692608867429622675756052317277752035361393621076738937645560606059216589466759551900400555908950229530942312482355212212415444006470340565734797663972394949946584578873039623090375033993856210242369025138680414577995698122445747178034173126453220416397232134044449487302315417676893752103068737880344170093954409627955898678723209512426893557309704509595684401755519881921802064052905518934947592600734852282101088194644544222318891319294689622002301443770269923007803085261180754519288770502109684249362713592518760777884665836150238913493333122310533923213624319263728910670503399282265263556209029798642472759772565508615487543574826471814145127000602389016207773224499435308899909501680328112194320481964387675863314798571911397815397807476150772211750826945863932045652098969855567814106968372884058746103378105444390943683583581381131168993855576975484149144534150912954070050194775486163075422641729394680367319805861833918328599130396072014455950449779212076124785645916160837059498786006970189409886400764436170933417270919143365013715766011480381430626238051432117348151005590134561011800790506381421527093085880928757034505078081454588199063361298279814117453392731208092897279222132980642946878242748740174505540677875708323731097591511776297844328474790817651809778726841611763250386121129143683437670235037111633072586988325871033632223810980901211019899176841491751233134015273384383723450093478604979294599158220125810459823092552872124137043614910205471855496118087642657651106054588147560443178479858453973128630162544876114852021706440411166076695059775783257039511087823082710647893902111569103927683845386333321565829659773103436032322545743637204124406408882673758433953679593123221343732099574988946995656473600729599983912881031974263125179714143201231127955189477817269141589117799195648125580018455065632952859859100090862180297756378925999164994642819302229355234667475932695165421402109136301819472270789012208728736170734864999815625547281137347987165695274890081443840532748378137824669174442296349147081570073525457070897726754693438226195468615331209533579238014609273510210119190218360675097308957528957746814229543394385493155339630380729169175846101460995055064803679304147236572039860073550760902317312501613204843583648177048481810991602442523271672190189334596378608787528701739359303013359011237102391712659047026349402830766876743638651327106280323174069317334482343564531850581353108549733350759966778712449058363675413289086240632456395357212524261170278028656043234942837301725574405837278267996031739364013287627701243679831144643694767053127249241047167001382478312865650649343418039004101780533950587724586655755229391582397084177298337282311525692609299594224000056062667867435792397245408481765197343626526894488855272027477874733598353672776140759171205132693448375299164998093602461784426757277679001919190703805220461232482391326104327191684512306023627893545432461769975753689041763650254785138246314658336383376023577899267298863216185839590363998183845827644912459809370430555596137973432613483049494968681089535696348281781288625364608420339465381944194571426668237183949183237090857485026656803989744066210536030640026081711266599541993687316094572288810920778822772036366844815325617284117690979266665522384688311371852991921631905201568631222820715599876468423552059285371757807656050367731309751912239738872246825805715974457404842987807352215984266766257807706201943040054255015831250301753409411719101929890384472503329880245014367968441694795954530459103138116218704567997866366174605957000344597011352518134600656553520347888117414994127482641521355677639403907103870881823380680335003804680017480822059109684420264464021877053401003180288166441530913939481564031928227854824145105031888251899700748622879421558957428202166570621880905780880503246769912972872103870736974064356674589202586565739785608595665341070359978320446336346485489497663885351045527298242290699848853696828046459745762651434359050938321243743333870516657149005907105670248879858043718151261004403814880407252440616429022478227152724112085065788838712493635106806365166743222327767755797399270376231914704732395512060705503992088442603708790843334261838413597078164829553714321961189503797714630007555975379570355227144931913217255644012830918050450089921870512118606933573153895935079030073672702331416532042340155374144268715405511647961143323024854404094069114561398730260395182816803448252543267385759005604320245372719291248645813334416985299391357478698957986439498023047116967157362283912018127312916589952759919220318372356827279385637331265479985912463275030060592567454979435088119295056854932593553187291418011364121874707526281068698301357605247194455932195535961045283031488391176930119658583431442489489856558425083410942950277197583352244291257364938075417113739243760143506829878493271299751228688196049835775158771780410697131966753477194792263651901633977128473907933611119140899830560336106098717178305543540356089529290818464143713929437813560482038947912574507707557510300242072662900180904229342494259060666141332287226980690145994511995478016399151412612525728280664331261657469388195106442167387180001100421848302580916543383749236411838885646851431500637319042951481469424314608952547072037405566913069220990804819452975110650464281054177552590951871318883591476599604131796020941530858553323877253802327276329773721431279682167162344211832018028814127474431688472184593927814354740999990722332030592629766112383279833169882539312620065037028844782866694044730794710476125586583752986236250999823233597155072338383324408152577819336426263043302658958170800451278873115935587747217256494700051636672577153920984095032745112153687300912199629522765913163709396860727134269262315475330437993316581107369643142171979434056391551210810813626268885697480680601169189417502722987415869917914534994624441940121978586013736608286907223651477139126874209665137875620591854328888341742920901563133283193575622089713765630978501563154982456445865424792935722828750608481453351352181729587932991171003247622205219464510536245051298843087134443950724426735146286179918323364598369637632722575691597239543830520866474742381511079273494836952396479268993698324917999502789500060459661313463363024949951480805329017902975182515875049007435187983511836032722772601717404535571658855578297291061958193517105548257930709100576358699019297217995168731175563144485648100220014254540554292734588371160209947945720823780436871894480563689182580244499631878342027491015335791072733625328906933474123802222011626277119308544850295419132004009998655666517756640953656197897818380451030356510131589458902871861086905893947136801484570018366495647203294334374298946427412551435905843484091954870152361403173913903616440198455051049121169792001201999605069949664030350863692903941007019450532016234872763232732449439630480890554251379723314751852070910250636859816795304818100739424531700238804759834323450414258431406361272109602282423378228090279765960777108493915174887316877713522390091171173509186006546200990249758527792542781659703834950580106261553336910937846597710529750223173074121778344189411845965861029801877874274456386696612772450384586052641510304089825777754474115332076407588167751497553804711629667771005876646159549677692705496239398570925507027406997814084312496536307186653371806058742242598165307052573834541577054292162998114917508611311765773172095615656478695474489271320608063545779462414531066983742113798168963823533304477883169339728728918103664083269856988254438516675862289930696434684897514840879039647604203610206021717394470263487633654393195229077383616738981178124248365578105034169451563626043003665743108476654877780128577923645418522447236171374229";


/**
 * Fibonacci Sequence - Concatenated digits from Fibonacci numbers
 * Source: http://planetmath.org/listoffibonaccinumbers
 *
 * GENERATION METHOD:
 * 1. Calculate Fibonacci sequence: 0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144...
 * 2. Concatenate all digits: "01123581321345589144..."
 *
 * MUSICAL CHARACTERISTICS:
 * - ~290 occurrences of Fibonacci sub-sequences within the string
 * - Natural rhythm: patterns emerge at iteration 17+ (4-beat and 8-beat cycles)
 * - More repetitive than Pi/Phi (limited to digits used in Fibonacci numbers)
 *
 * LENGTH: ~1000+ digits
 *
 * PATTERN NOTES:
 * - Starting from iteration 17, musical patterns repeat in 4-beat and 36-beat (9 bars) cycles
 * - This creates natural musical phrases and could be exploited for rhythmic variations
 * - Lower digit diversity compared to Pi (some digits appear more frequently)
 */
var fib = "01123581321345589144233377610987159725844181676510946177112865746368750251213931964183178115142298320401346269217830935245785702887922746514930352241578173908816963245986102334155165580141267914296433494437701408733113490317018363119032971215073480752697677787420491258626902520365011074329512800995331629117386267571272139583862445225851433717365435296162591286729879956722026041154800875592025047307819614052739537881655747031984210610209857723171676801775652777789003528844945570212853727234602481411176690304609941903924907091353080615211701294984540118792648065155330493931304969544928657211148507797805034164546229067075527939700884757894439432379146414472334024676221234167283484676853788906237314390661305790721611591991948530947554971605006438163670882596954969111225854201961407274896736798916376386122581100087778366101931177997941600471418928800671943708161204660046610375530309754011380474634642912200160415121876738197402742198682231673194043463499009990551680708854858323072836211434898484229771353018523447067460492189229958345551690263542248481792619150755731478440138170841019273726921930789991761500520536206896083277242789322839997508245339284137646068711657306356306993006846248183102847207576137174139131664102775062056366209626925748508234281076009435667762588548447381057049252476708912581411411405930102594397055221918455182579303309636633329861112681897706691855248316295261201016328488578177407943098723020343712649370320429973934883222046711111473984623691759331164814351698201718008153583592549909666408718408670007398507948658051921140283666534989152989237612269837405200686395697568236726740705505779255899443594251147575126432128751259615185546301842246877456815557697022053106568164969325172882568354948815042426140730579590408055383207395465903462158763004198249821510663404174917105958145721691725375039079340637797070384279171545657105123361164255345170904956503918714087129377308805952221443105020355490118258964478718349764290684271913470240009327808144942391730960598847965113057878492344500953012480583911393279162618105590009602350419720640860513115120134408189533653432486621220710144010539953374073347134335830278418729487027505833755556540422429269440401579180889892370700847998927429085014514544891112327726836783066419532353412818241252672952597492098380790192947402535663090413405161613147477152780295835016261499969216677189303386214405760200161305314249045814157979073863492609974810209388480201231314654942230279526998466217810220532898683300276290923510198225336794471105603071560908172376327542123451788903347851831682574552878917922894506419412739854950880421041374683409767264571537525433299959297577916186677311392476313721000661226132595394188293000174702095995198392421406191943224780607419606132100568094561077252479807762920565193981023518027157495786850488117840403783297413488274376762678017313598018856492162040239554477268290220020566894662969229833221040484633560007554595845896322287658131675357602132235424755886206198685365216932022077813832148494290752666819691508043400168079707356352739520471852440065477981911855850643492187291543948108878149991563206996231707763396388174356131903419057639723895054931033628323428189498226463595560281832167244575904137984013222756794978732527060740824695693383586911635100691574378519841510949178490918731459856482708459392398051851684960989496992563911463113765491467695340528626429782121185477076894719862121901385213997077603001082145496345390753066714782948988148558529144435440119720805669229197641785693505993988940272514728170586875221271278797438343341469722784862878851632056972303432332281742237513033465726853328251100870675623211960297896344578485385223404303007904954197810929810305338713474505173683528166158108826154883811409869790947669143312035591975596518914228121724146503749612865140285821200729536910870324127066394406869948338085262095972304273877744135569338397692020533504966339130629045077501002539252582905971315635695580168194910579363790217849593217252990868864586456855893891827436786529304093478246662684059616875297296152824614766233869353085486281758142155705206899077107168651819712326877926895128666735145224173402521172797813159685037284371942044301280571172992510140037611932413038677189525453973694165307953197296969697410619233826734544867157818093234908902110449296423351118851856132312604643220587180785991565717719230634284809441396671147739183092120805283111581989804070186099320645726169127737705503464541828501432576643541964447833981823381462274080890845118657560653706474675559381318087282637409883763219148501512580737417121327100234463183349497947550385773274930109345079730608372821871301390354008990823042805583507329530046553662808658578667235723438990343046356137747723758225621187571439538669146178119651438213260386312206974243796773058236521166007575960984144537828161815236311727382699285659014174244530850035136059033084785619220451666590135228675387863297874269396512100191973732560430947320623789843393330248129716211401889921944447018816257617318075718778092623059926317798754175087863660165740874359106424420011530999319887696948942189754844623691568672600416277919530520573530820632893205960211111146015693778515192902684250396083776683293617978720198565577104981084195586024127087428957290901803555033622569101110380899849648542618934706890055406893936189119523367600909194169085076159080909572301618801306271765994056795952743123227981463641240980692501505442003148737643593199387062373213542599493807777207997205533596336322615043836854783580186309282650000354271239929522002106210068326179680117059857997559804836265844617150046923109759866426342507997914076076194136661925625699143593954654340236599547388091245922112364063039145456994129697448739933879569886533577855662560905981638959513147239988861837901112578909206886482052733837248289211398224979488976593669477314257265089773319960393539711116327908771515603980029054703631570447893146795336142768064224522987531716273545293036474970821924473060471519396790273320068205816087409539022898778344881521616420201486372309412690177742887311180230754862368010388104219572991470851051838277540168014203677584116808305705945300883541229581164851348244958539952127196409925518292354392281419442391516259162217536244004715631463593237933511000607242864504120757488371201125556981885592325792420049634380763282975024511520584118844547883025930342065687724526740373251281864069667454273644225850958407065116260306867075373301612807933872843252844399261363388871298090440050148801977467930020767542949510206990049732877714758747896325826131730509282738943634332893686268675876375127765235729247325860370338946550318986595564473522492067284939905646309531977283828936479234582512322862433449372971981195681356806732944396691005381570580873541222223710376587766765795712337614833512066938094978757159534301885445803338630417815817435658826439037014169381771405651323470996587541191965770779495819986722926541305707536769274335217959007783206438322259023737095923077113188092745331805500199748977217818079010460022464382820724862019667023459207532183656140338034197118387459933912954764998828959407281160873958417044515714085184275463781678466585241861481334453009875507862542592393026885507715496646813780220945054040571721231411400091145443188588334330533796636907849934155927201766565933044813173935988399521517465900235533821309932481077059421593574927948218325748971295910205272369026526517427187520417066673081023209641459549125606105821258513281977817363528159525632064671311725082276588295115237784562496925676988262564422967677263205735326493533278229173822750993122698578207436143903804565580923764844306069119447720249892581203851665820676436622934188700177088360193270471243015279782059101964580241188515112465021394429312718191492907860985910767785256677811449301165198482789505988662735923140767969869749836918999964413630219877218818706854228831001753880637535093596811413714795418360007132469551696475414252185050728493051581137812842563823722521434023711935851442757311448200241126227918432210565972323468097888158339286797581652104954628434169971646694834457561150025935192443107331279692497874105696181486775143168990795981475102637178708944490299333694911317865144462661461469109840686218814894420724595491211054809360138219769783523770696554372451866815101694984845480039225387896643963981384617949612346400157593089409397575905873189892788416618166223249151560709188257441063592460307062654437717548562579710069428647684173189833371957686436066121386336645432728761316292677799244882378090813021278896373184040774362981291341026362106446929055567924184978965332439305427111008414020102342654784246173937946014998000244228812489467885371395311443369016890693102993513939182979209561251794894996379809331545611167167493927693145995418097945379006428436288175120464298891806885656323799249738933639586633513160792578781310139745345"

// ============================================================================
// SYNESTHESIA COLOR MAPPING
// ============================================================================
/**
 * Maps digits (0-9) to colors for visual representation
 *
 * USAGE: Currently controlled by 'drawPi' flag in draw_music_elements.js
 * When enabled, each note displays its corresponding digit in color
 *
 * COLOR PALETTE:
 * 0 → White      (neutral, silence)
 * 1 → Black      (fundamental, root)
 * 2 → Yellow     (bright, energetic)
 * 3 → Red        (warm, strong)
 * 4 → Blue       (cool, stable)
 * 5 → Green      (natural, balanced)
 * 6 → Pink       (soft, gentle)
 * 7 → Orange     (vibrant, active)
 * 8 → Purple     (mysterious, complex)
 * 9 → Brown      (earthy, grounded)
 *
 * FUTURE ENHANCEMENT:
 * - Allow user to customize color mappings
 * - Create preset color schemes (rainbow, monochrome, etc.)
 * - Animate color transitions based on music dynamics
 */
var synesthesisTable = {
	0 : "#FFFFFF",  // White
	1 : "#000000",  // Black
	2 : "#FFFA00",  // Bright yellow
	3 : "#FF3333",  // Red
	4 : "#0080FF",  // Blue
	5 : "#00994C",  // Green
	6 : "#FF99CC",  // Pink
	7 : "#FF9933",  // Orange
	8 : "#8C19FF",  // Purple
	9 : "#663300"   // Brown
};

// ============================================================================
// MUSICAL SCALES - Digit to Note Mapping
// ============================================================================
/**
 * Maps digits (0-9) to MIDI interval numbers (semitones from C3)
 *
 * HOW IT WORKS:
 * 1. Get digit from sequence: e.g., "3" from Pi
 * 2. Select scale: e.g., scales[1] = Major scale
 * 3. Map digit to interval: scales[1][3] = 5 (F in C major)
 * 4. Add transposition: interval + current_tone
 * 5. Convert to note name: interval2notes[5] = "F3"
 *
 * Each scale contains 10 intervals (one for each digit 0-9)
 * Intervals are semitones from C3 (MIDI note 48)
 *
 * EXAMPLE: Major scale [0,2,4,5,7,9,11,12,14,16]
 * - Digit 0 → 0 semitones → C
 * - Digit 1 → 2 semitones → D
 * - Digit 2 → 4 semitones → E
 * - Digit 3 → 5 semitones → F
 * - Digit 4 → 7 semitones → G
 * - Digit 5 → 9 semitones → A
 * - Digit 6 → 11 semitones → B
 * - Digit 7 → 12 semitones → C (octave)
 * - Digit 8 → 14 semitones → D (octave)
 * - Digit 9 → 16 semitones → E (octave)
 *
 * This maps all 10 digits into a musical framework while preserving
 * the mathematical sequence's pattern.
 *
 * References:
 * - https://en.wikipedia.org/wiki/Octatonic_scale
 * - http://www.pianoscales.org/nine-tone.html
 */

/* ALTERNATIVE SCALE CONFIGURATIONS (commented out)
 *
 * Octatonic variations (8-note scale cycling):
 * var scales = [
 *     [0, 1, 3, 4, 6, 7, 9, 12, 13, 15],  // Pattern 1
 *     [5, 6, 8, 9, 11, 12, 14, 17, 18, 20], // Pattern 2
 *     [4, 5, 7, 8, 10, 11, 13, 16, 17, 19]  // Pattern 3
 * ]
 *
 * Nonatonic variations (9-note scale cycling):
 * var scales = [
 *     [0, 2, 3, 4, 6, 7, 8, 9, 11, 12],  // "linear"
 *     [1, 3, 4, 5, 7, 8, 9, 10, 12, 13], // Transposed +1
 *     [2, 4, 5, 6, 8, 9, 10, 11, 13, 14], // Transposed +2
 *     [3, 5, 6, 7, 9, 10, 11, 12, 14, 15], // Transposed +3
 *     [4, 6, 7, 8, 10, 11, 12, 13, 15, 16]  // Transposed +4
 * ]
 */

var scales = [
    // Index 0: LINEAR - Direct chromatic mapping (all 10 semitones)
    // Each digit directly maps to a semitone: 0→C, 1→C#, 2→D, etc.
    [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],

    // Index 1: MAJOR - C major scale extended to 10 notes
    // Traditional major scale: C D E F G A B + octave extensions
    // Intervals: W W H W W W H (where W=whole step, H=half step)
    [0, 2, 4, 5, 7, 9, 11, 12, 14, 16],

    // Index 2: MINOR - Natural minor scale extended
    // Traditional minor feel: C D Eb F G Ab Bb + octaves
    // Intervals: W H W W H W W
    [0, 1, 4, 5, 7, 8, 11, 12, 13, 16],

    // Index 3: HARMONIC MINOR - Minor with raised 7th
    // Characteristic Middle Eastern/classical sound
    // Features augmented 2nd interval (Ab to B)
    [0, 2, 3, 5, 7, 8, 11, 12, 14, 15],

    // Index 4: LYDIAN DOMINANT - Jazz/modal scale
    // Lydian mode with dominant 7th
    // Bright sound with #4 and b7
    [0, 2, 4, 6, 7, 9, 10, 12, 14, 16],

    // Index 5: CHROMATIC BLUES - Blues-influenced chromatic
    // All chromatic tones in first octave
    // Creates dense, bluesy harmonies
    [0, 2, 3, 4, 5, 6, 7, 9, 10, 11],

    // Index 6: WHOLE TONE - All whole steps
    // Debussy-esque, dream-like quality
    // No leading tone, ambiguous tonality
    // Pattern: C D E F# G# A# C D E F#
    [0, 2, 4, 6, 8, 10, 12, 14, 16, 18],

    // Index 7: DIMINISHED - Octatonic scale (alternating whole/half steps)
    // Used in jazz and classical music
    // Symmetrical structure creates tension
    [0, 2, 3, 5, 6, 8, 9, 11, 12, 14],

    // Index 8: PENTATONIC BLUES - Blues pentatonic extended
    // Classic blues/rock scale
    // Combines minor pentatonic with blues notes
    [0, 2, 3, 4, 7, 8, 9, 12, 14, 15],

    // Index 9: IN-SEN - Japanese traditional scale
    // Note: Has 12 notes (extends beyond typical 10)
    // Creates exotic, Eastern musical flavor
    // Based on Japanese koto music
    [0, 2, 3, 7, 9, 10, 12, 14, 15, 19, 21, 22],

    // Index 10: OCTATONIC - Eight-tone scale
    // Also called "diminished scale"
    // Symmetric structure (H-W-H-W-H-W-H-W)
    [0, 1, 3, 4, 6, 7, 9, 12, 13, 15],

    // Index 11: NONATONIC - Nine-tone scale
    // Contains 9 unique notes within octave
    // Custom scale for maximum digit coverage
    [0, 2, 3, 4, 6, 7, 8, 9, 11, 12]
]

// ============================================================================
// INTERVAL TO NOTE NAME MAPPING
// ============================================================================
/**
 * Converts MIDI interval numbers to note names with octave
 *
 * RANGE: C3 to B5 (3 octaves, 36 semitones)
 * - C3 = Middle C area (MIDI note 48)
 * - B5 = 3 octaves up (MIDI note 83)
 *
 * FORMAT: "NoteName + Octave"
 * - Sharps: C#, F#, G#
 * - Flats: Eb, Bb (enharmonic to C#, A#)
 *
 * USAGE:
 * 1. Calculate interval from scale + transposition
 * 2. Look up note name: interval2notes[12] = "C4"
 * 3. Pass to soundfont-player for audio synthesis
 *
 * MUSICAL NOTE:
 * - Uses a mix of sharp (#) and flat (b) notation
 * - Eb instead of D#, Bb instead of A#
 * - This is for readability/convention, not functional difference
 */
var interval2notes = {
    // Octave 3 (lower register)
    0 : "C3",    // Root note
    1 : "C#3",   // C sharp / D flat
    2 : "D3",
    3 : "Eb3",   // E flat / D sharp
    4 : "E3",
    5 : "F3",
    6 : "F#3",   // F sharp / G flat
    7 : "G3",
    8 : "G#3",   // G sharp / A flat
    9 : "A3",    // A440 reference (actually A3 is 220Hz)
    10 : "Bb3",  // B flat / A sharp
    11 : "B3",

    // Octave 4 (middle register)
    12 : "C4",   // Middle C area
    13 : "C#4",
    14 : "D4",
    15 : "Eb4",
    16 : "E4",
    17 : "F4",
    18 : "F#4",
    19 : "G4",
    20 : "G#4",
    21 : "A4",   // A440 - Concert pitch reference
    22 : "Bb4",
    23 : "B4",

    // Octave 5 (higher register)
    24 : "C5",
    25 : "C#5",
    26 : "D5",
    27 : "Eb5",
    28 : "E5",
    29 : "F5",
    30 : "F#5",
    31 : "G5",
    32 : "G#5",
    33 : "A5",
    34 : "Bb5",
    35 : "B5",   // Highest note in range
}

// ============================================================================
// NOTE TO STAFF POSITION MAPPING
// ============================================================================
/**
 * Maps note names to vertical positions on musical staff
 *
 * STAFF STRUCTURE (Treble Clef):
 * - 5 horizontal lines numbered 0-4 from bottom
 * - Notes sit ON lines or IN spaces between lines
 * - Position 0 = middle line (B4 in treble clef)
 * - Negative positions = below staff (require ledger lines)
 * - Positive positions = above staff (require ledger lines)
 *
 * POSITION UNITS:
 * - Each unit = half a line spacing
 * - Position increases by 0.5 for each semitone/line
 * - Sharps/flats share position with their natural note
 *
 * EXAMPLES:
 * - C3 = -2/2 = -1.0 (one line below staff, needs ledger line)
 * - E4 = 7/2 = 3.5 (space between 3rd and 4th line)
 * - C5 = 12/2 = 6.0 (well above staff, needs ledger lines)
 *
 * USAGE in draw_music_elements.js:
 * ypos = offset + (spacing*4) - notes2position[noteName] * spacing
 *
 * NOTE: This mapping is for TREBLE CLEF
 * Bass clef would need different position mappings
 */
var notes2position = {
    // Octave 3 - Below staff (negative positions, need ledger lines)
    "C3"  : -2/2,   // -1.0: one ledger line below staff
    "C#3" : -2/2,   // Same position as C3
    "D3"  : -1/2,   // -0.5: just below staff
    "Eb3" : +0/2,   // 0: bottom line of staff
    "E3"  : -0/2,   // 0: bottom line (same as Eb3)
    "F3"  : +1/2,   // 0.5: first space
    "F#3" : +1/2,
    "G3"  : +2/2,   // 1.0: second line
    "G#3" : +2/2,
    "A3"  : +3/2,   // 1.5: second space
    "Bb3" : +4/2,   // 2.0: middle line
    "B3"  : +4/2,

    // Octave 4 - On staff (main playing range)
    "C4"  : +5/2,   // 2.5: third space
    "C#4" : +5/2,
    "D4"  : +6/2,   // 3.0: fourth line
    "Eb4" : +7/2,   // 3.5: fourth space
    "E4"  : +7/2,
    "F4"  : +8/2,   // 4.0: top line of staff
    "F#4" : +8/2,
    "G4"  : +9/2,   // 4.5: just above staff
    "G#4" : +9/2,
    "A4"  : +10/2,  // 5.0: one ledger line above
    "Bb4" : +11/2,  // 5.5
    "B4"  : +11/2,

    // Octave 5 - Above staff (positive positions, need ledger lines)
    "C5"  : +12/2,  // 6.0: two ledger lines above
    "C#5" : +12/2,
    "D5"  : +13/2,  // 6.5
    "Eb5" : +14/2,  // 7.0: three ledger lines above
    "E5"  : +14/2,
    "F5"  : +15/2,  // 7.5
    "F#5" : +15/2,
    "G5"  : +16/2,  // 8.0: four ledger lines above
    "G#5" : +16/2,
    "A5"  : +17/2,  // 8.5
    "Bb5" : +18/2,  // 9.0: five ledger lines above (very high!)
    "B5"  : +18/2   // Highest position

}

// ============================================================================
// PRESET CONFIGURATIONS
// ============================================================================
/**
 * Predefined musical configurations for quick experimentation
 *
 * NOTE: These presets reference rhythm names that don't exist in current code!
 * - "test1", "plain", "picking", "async-slow" are not implemented
 * - Current rhythms are: "Dialog", "Unisson Walk", "Canon Walk", "Vals", "Impromptu"
 *
 * TODO: Either update presets to use current rhythm names, or implement
 * these rhythm patterns, or create a preset loading system in dom.js
 *
 * Currently UNUSED - not connected to UI
 * Future enhancement: Add preset selector dropdown in GUI
 */

// Preset 1: Bright Piano - Classical Feel
var preset1 = {
    bpm : 60,                           // Moderate tempo
    soundBass : "bright_acoustic_piano",
    soundLead : "bright_acoustic_piano",
    current_scale : "major",            // Happy, uplifting
    current_rythm : "test1"             // ⚠️ Not implemented!
}

// Preset 2: Music Box - Delicate and Nostalgic
var preset2 = {
    bpm : 80,                           // Slightly faster
    soundBass : "music_box",
    soundLead : "music_box",
    current_scale : "harmonic_minor",   // Melancholic, mysterious
    current_rythm : "plain"             // ⚠️ Not implemented!
}

// Preset 3: Acoustic Guitar - Folk/World Music
var preset3 = {
    bpm : 100,                          // Upbeat
    soundBass : "acoustic_guitar_nylon",
    soundLead : "acoustic_guitar_nylon",
    current_scale : "pentatonic",       // World music feel
    current_rythm : "picking"           // ⚠️ Not implemented!
}

// Preset 4: Ethereal Voices - Ambient/Meditative
var preset4 = {
    bpm : 45,                           // Slow, contemplative
    soundBass : "voice_oohs",
    soundLead : "voice_oohs",
    current_scale : "in-sen",           // Japanese traditional scale
    current_rythm : "async-slow"        // ⚠️ Not implemented!
}

/*
// based kick(2) and snare(1) rythms, first beat is always marked as 4
var rythms = {
 "test1": ["s","s","s","s","s","s","s","s",  "ff",0,"ff",0,"f","f","f","f"],
 "plain": ["ff",0,"ff",0,"ff",0,"ff",0],
 "async": ["s","ff",0,"ff",0,"ff",0,"f"],
 "picking": ["s",0,"f","f","ff",0,"f","f"]
 
}
// based kick(2) and snare(1) rythms, first beat is always marked as 4
var rythmsbass = {
 "test1": ["fff",0,0,0,"ffff",0,0,0,  0,0,0,0,0,0,"s","s"],
 "plain": ["ff",0,"ff",0,"ff",0,"ff",0],
 "async": ["fff",0,"ff",0,"ff",0,"ff",0],
 "picking": ["fff",0,0,0,"ff",0,"f","s"]
}
*/


// ============================================================================
// MIDI INSTRUMENT LIBRARY
// ============================================================================
/**
 * Available instruments for soundfont-player synthesis
 *
 * SOURCE: General MIDI (GM) standard instrument set
 * - 128 total instruments in GM spec
 * - ~110 working instruments in soundfont-player library
 * - Some instruments commented out (don't load properly)
 *
 * CATEGORIES:
 * - Keyboards: pianos, organs, harpsichord, celesta, accordion
 * - Guitars: acoustic, electric, distorted, harmonics
 * - Bass: acoustic, electric, slap, fretless
 * - Strings: violin, viola, cello, contrabass, pizzicato, tremolo
 * - Brass: trumpet, trombone, tuba, french horn, brass section
 * - Woodwinds: flute, clarinet, oboe, bassoon, saxophones
 * - Synths: leads, pads, sound effects
 * - World: koto, shamisen, sitar, shakuhachi, kalimba
 * - Percussion: timpani, bells, woodblock, steel drums
 * - Sound FX: rain, soundtrack, crystal, atmosphere, sci-fi, gunshot, helicopter
 *
 * USAGE in dom.js:
 * - Populates lead and bass instrument dropdown menus
 * - Each instrument name passed to Soundfont.instrument(ctx, name)
 *
 * TROUBLESHOOTING:
 * Commented instruments failed to load during testing:
 * - bagpipe, clavinet, lead_8_bass__lead
 * - reverse_cymbal, seashore, taiko_drum
 * - synth_brass_1/2, synth_choir, synth_strings_1/2, synth_drum
 *
 * Possible causes: corrupted soundfont files, browser compatibility,
 * or incorrect instrument name format in soundfont-player library
 */
var instrumentTable = [
    // Keyboards & Accordions
    "accordion",
    "bright_acoustic_piano",
    "acoustic_grand_piano",
    "electric_grand_piano",
    "electric_piano_1",
    "electric_piano_2",
    "honkytonk_piano",
    "harpsichord",
    "celesta",

    // Guitars
    "acoustic_guitar_nylon",
    "acoustic_guitar_steel",
    "electric_guitar_clean",
    "electric_guitar_jazz",
    "electric_guitar_muted",
    "overdriven_guitar",
    "distortion_guitar",
    "guitar_harmonics",
    "guitar_fret_noise",     // Percussive effect

    // Bass
    "acoustic_bass",
    "electric_bass_finger",
    "electric_bass_pick",
    "fretless_bass",
    "slap_bass_1",
    "slap_bass_2",
    "synth_bass_1",
    "synth_bass_2",

    // Strings (Orchestral)
    "violin",
    "viola",
    "cello",
    "contrabass",
    "string_ensemble_1",
    "string_ensemble_2",
    "pizzicato_strings",      // Plucked strings
    "tremolo_strings",        // Rapid bow movement
    "orchestral_harp",

    // Brass
    "trumpet",
    "trombone",
    "tuba",
    "muted_trumpet",
    "french_horn",
    "brass_section",
    //"synth_brass_1",        // Doesn't load properly
    //"synth_brass_2",        // Doesn't load properly

    // Woodwinds
    "flute",
    "piccolo",               // High flute
    "recorder",
    "pan_flute",
    "blown_bottle",          // Novelty instrument
    "clarinet",
    "oboe",
    "english_horn",          // Lower oboe
    "bassoon",
    "soprano_sax",
    "alto_sax",
    "tenor_sax",
    "baritone_sax",

    // Organs
    "church_organ",
    "drawbar_organ",         // Hammond B3 style
    "percussive_organ",
    "rock_organ",
    "reed_organ",

    // Choir & Voice
    "choir_aahs",
    "voice_oohs",            // Ethereal vocals
    //"synth_choir",         // Doesn't load properly

    // Synth Leads
    "lead_1_square",         // Square wave synth
    "lead_2_sawtooth",       // Sawtooth wave synth
    "lead_3_calliope",       // Circus organ sound
    "lead_4_chiff",          // Synth with attack
    "lead_5_charang",        // Guitar-like synth
    "lead_6_voice",          // Voice-like synth
    "lead_7_fifths",         // Parallel fifths
    //"lead_8_bass__lead",   // Doesn't load properly

    // Synth Pads
    "pad_1_new_age",         // Ambient pad
    "pad_2_warm",            // Warm analog pad
    "pad_3_polysynth",       // Polyphonic synth
    "pad_4_choir",           // Choir-like pad
    "pad_5_bowed",           // Bowed glass sound
    "pad_6_metallic",        // Metallic shimmer
    "pad_7_halo",            // Angelic sound
    "pad_8_sweep",           // Sweeping filter

    // Sound Effects
    "fx_1_rain",             // Rain ambiance
    "fx_2_soundtrack",       // Cinematic effect
    "fx_3_crystal",          // Crystalline sound
    "fx_4_atmosphere",       // Atmospheric pad
    "fx_5_brightness",       // Bright shimmer
    "fx_6_goblins",          // Spooky effect
    "fx_7_echoes",           // Echo effect
    "fx_8_scifi",            // Science fiction sound
    "gunshot",               // Percussion effect
    "helicopter",            // Mechanical sound
    "telephone_ring",        // Phone ringing
    "applause",              // Crowd applause
    "bird_tweet",            // Nature sound
    "breath_noise",          // Breathing sound

    // World Instruments
    "koto",                  // Japanese zither
    "shakuhachi",            // Japanese flute
    "shamisen",              // Japanese lute
    "sitar",                 // Indian sitar
    "banjo",                 // American folk
    "kalimba",               // African thumb piano
    "shanai",                // Indian oboe
    //"bagpipe",             // Doesn't load properly
    //"clavinet",            // Doesn't load properly

    // Percussion & Bells
    "timpani",               // Orchestral drums
    "tubular_bells",         // Chimes
    "tinkle_bell",           // Small bell
    "glockenspiel",          // Metal xylophone
    "vibraphone",            // Electric xylophone
    "marimba",               // Wooden xylophone
    "xylophone",             // High wooden bars
    "steel_drums",           // Caribbean steel pan
    "woodblock",             // Percussion block
    "agogo",                 // Brazilian cowbell
    "melodic_tom",           // Tuned drums
    //"taiko_drum",          // Doesn't load properly
    //"synth_drum",          // Doesn't load properly

    // Specialty
    "music_box",             // Delicate mechanical sound
    "harmonica",             // Mouth harp
    "ocarina",               // Clay flute
    "fiddle",                // Folk violin
    "dulcimer",              // Hammered strings
    "tango_accordion",       // Argentine accordion
    "whistle",               // Human whistle
    "orchestra_hit",         // Stab chord
    //"reverse_cymbal",      // Doesn't load properly
    //"seashore",            // Doesn't load properly
];
